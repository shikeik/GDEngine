# 临时策划
1 版本号定义为v17，表示键盘适配版本
2 键盘映射: 移动ad下蹲s没问题, 跳跃仅k键，上键可能与摇杆上滑作为未来的上段动作输入所以不行，攻击j冲刺L，大招O(没别的因为大家默认都是O)
3 技能适配: 
- 冲刺: 是的电脑上的操作键与方向键不同没有方向性意义，所以只能用AD+L来表示方向, 额外的，如果不按方向键单L那么默认为朝向敌方，以及为了统一性，触屏操作也要与此一致(左右方向为冲刺方向, 不触摸摇杆则朝向敌方方向)
- 闪刀: 是的，s+L，方向为敌方方向，暂时不可背向敌人施放，因为我们目前的机制是角色根据双方站位自动面向敌人，如果以后变为存储当前朝向那么就可以变为当前朝向了(其他类似技能也是)，不过现在为了简单性暂时保持这样
- 大招: O键
4 ui提示方面: 在右侧屏一小块区块显示一个搓招时间表是非常有必要的，这对调试预期搓招至关重要，否则开发者不能直观明白当前到底触发了哪个搓招，是按键错误没触发还是代码执行失败逻辑问题，所以这很重要，并且设计一个美观的界面，列表同时最大显示n个搓招, 最新按键情况会顶掉之前的，这里有个核心逻辑忘说了: 搓招有一个极快的判定时长，比如0.4s之内同时按下指定多个键才视为触摸目标搓招，然后搓招时间表每一列怎么实现呢: 按下1个键后就将其视为这次操作起点即一列搓招，在搓招时间内完成了所有招式按键输入那么，所有搓招按键被消耗，事件触发，且push该搓招到搓招时间表上，emm不对，搓招应该有顺序是一个链式顺序，比如假设有↓→+J那么必须先↓然后接→再接J, 如果不是↓起手那么不会命中此招式，如果↓接了L那么命中的就是另一招式，如果↓接了任何连不上搓招的键比如↑那么↓就会被单独列到按键时间表因为它没有后续了，此时继续↑的搓招判定等待，超过0.4s或按错了没有接上搓招按键那么↑就断了，也单独列出，对就是这样。
以上为全部设计修正，然后一个重点，就是此次更新内容较多，逻辑较为复杂，所以最好直接复制最小耦合相关类与简化视觉内容到新页面中，然后用这个白板页面来独立测试新的双端输入系统以及搓招判定系统还有搓招时间表ui，这部分需求还未明确，
总之以上，你可以先基于补充重新修正更新方案(以及明确新页面相关, 还有防止你遗忘触屏端映射也一并贴出), 并再次与我一一确认，我允许后才可开始给出代码



1 输入映射方面: 你的触屏和键盘输入映射到虚拟指令是对的但备注理解不对，这些指令就只是叫那个名字，和实际上怎么用没有任何关系，他只是一个虚拟指令id，就算到时候把CMD_ULT用于跳跃也有可能(虽然这只是个玩笑不会真的那么做:))
2 Dash逻辑：这块把触屏和按键的搓招不用混为一谈，后面搓招表我会细说
3 搓招表与按键映射
- 这里需要围绕这两个词进行深度设计：
- - 但其实也很简单，就是把不同的硬件输入映射到相同的虚拟指令上，这个虚拟指令说起来有两类: (操作指令和招式指令)，但实际作用是一样的: 就是执行相应行动逻辑，
- - - 比如wasd以及斜向wa,wd,as,sd/摇杆上下左右,左上右上左下右下这些映射到Action_xxx，然后通过统一的Action_xxx来转化为vec2向量，其他基本也一样
- - - 但是有个特殊的，滑屏的冲刺是带有方向信息的，而按键L可没有，这里要分化处理，当然我们可以简单的做相同处理: (把滑屏冲刺退化为无方向仅冲刺键然后这样触屏与键盘都统一AD决定方向，但这样在触屏玩家看来非常反直觉:我往左滑结果却因为按住D往右冲刺，这是非常令人恶心的，也是开发者应杜绝的问题), 所以这里我们将滑屏冲刺直接映射为Skill_Dush(left/right), 将键盘AD+L也映射为其招式，这样即可解决该问题
4 搓招判断流程: 这块你说的基本没问题: 
- 新输入触发时推入buffer并重置计时器
- 匹配搓招表，匹配到则顺序匹配招式链按键(这里你需要举几个例子包括正常与极端情况来向我证明你确实理解此判断机制与流程)
- 断连结算, 都没啥问题
5 断连时间表ui设计: 
- 这块背景与列表行为没问题，
- 但是条目样式修正: 应根据虚拟指令表(包括操作与招式, 补充这个分别只用于归类限定前缀Action_..与Skill_..暂时无其他意义)定义来显示, 例如: "左 «"这是左指令，输入表为触屏左, "攻击 TAP"以及"攻击 J"分别是攻击指令输入为触屏点击和键盘J键
- - ui这里工作量比较大，需要给每个不同显示做好不同图标，但前期可以设计的简单一点，不过底座圆背景是需要的以表示这是一个图标，总之你自行设计，并罗列出来
- - 这块你也需要举几个例子以证明你理解此显示
6 测试场景
- 内容：其他都可以不要，只要几个
- - 俩角色，简单蓝红矩形表示，相机则全图视野且固定表示
- - - 玩家角色可移动以用于测试不同朝向下的连招，不过也仅复刻移动跳跃以及确保参数一致，其他都不用做，攻击技能都不需要，我们只需要查看各种输入情况下搓招时间表是否正确识别即可
- - 其他ui简单框出包围盒表示，搓招显示需要放到x左贴边y在上方ui下边的位置(有一定间距), 这里如果判定成功需发出事件，显示log(可以简单做一个ui放在屏幕中下方)
以上，内容较多，认真细读理解，并再次修正方案，然后让我确认，我确认完成后再开始给出代码，并且我们遵循先完成，再优化(包括表现上和代码结构设计上)的准则，来吧，给出最终方案(如果你完全理解那么这应该就是最终方案了)





# ai
好的我已应用更新并确实修复问题，且连击ui布局的-50%改为+50%放在右边布局更舒适, 接下来下个版本: 
## v16: 
- 没有冲刺，下+冲刺可以"闪刀"，这需要升级滑杆为定制化八向滑杆为后续搓招打下基础

以上，思考原因并提出解决方案, 需与我讨论确认，确认方案后才可给出修复代码与更新位置，并由我自行更新代码。



# 备忘：
- v16.3冲刺与闪刀细化: 
- - 冲刺的位移逻辑有问题: 位移方向应与移动方向无关而仅取决于手势左右方向
- 玩家难以被ai打中的bug


# 版本修复: 
## v16应修复: 
- 没有冲刺，下+冲刺可以"闪刀"，这需要升级滑杆为定制化八向滑杆为后续搓招打下基础
## v15应修复: 
- 细节优化: 没有扣血字效，没有连击字效，击败时缓效果应延长到粒子飞散开再弹出结算
## v13应修复: 
- v11时当敌人被击败，没有重玩界面，以及释放完大招敌人不扣血，且敌人ai不动了，以及血量也不动了
- - 预期修复完大招可以正常扣血，且敌人ai正常运行，且一方失败后展示结算ui界面并有重玩按钮
#4 v12应修复: 
思路：
- 镜头中心y应以角色双方y中心为y，这样当双方纵向移动时才可正确跟随而不是锁死固定y高度
- - 为验证当前会锁死，增加几个平台，至少两层，供玩家跳跃到三楼，此时固定镜头就会捕捉不到玩家，
- - 验证完成后，再来解决镜头y跟随问题，此时这里延伸一个可能的问题: 缩放x会框住角色双方，但y是否能正确框住，有待验证(但如果固定高度那么即使y能自动缩放也不会正确居中，依然为错误效果，所以必须先修正此问题)

